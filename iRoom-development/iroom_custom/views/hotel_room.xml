<?xml version="1.0" encoding="utf-8"?>

<odoo>

    <data>

        <record id="custom_view_room_kanban" model="ir.ui.view">

            <field name="name">custom_view_room_kanban</field>

            <field name="model">hotel.room</field>

            <field name="inherit_id" ref="hotel.view_room_kanban"/>

            <field name="arch" type="xml">

                <xpath expr="//kanban" position="replace">

                    <kanban class="o_hr_employee_kanban" sample="1" action="action_view_room_reservation" type="object"

                            js_class="room_legend_kanban">

                        <field name="id"/>

                        <field name="name"/>

                        <field name="shop_id"/>

                        <field name="categ_id"/>

                        <field name="floor_id"/>

                        <field name="image_1920" widget="image" options="{'size': 'medium'}"/>

                        <field name="company_id"/>

                        <field name="room_state"/>

                        <field name="room_partner_id"/>

                        <field name="room_ref"/>

                        <field name="room_check_in"/>

                        <field name="room_check_in_time"/>

                        <field name="room_check_out"/>

                        <field name="room_check_out_time"/>

                        <field name="room_total_nights"/>

                        <field name="room_booking_date"/>

                        <field name="room_adults"/>

                        <field name="room_children"/>

                        <templates>

                            <t t-name="kanban-box">

                                <div t-if="record.room_state.raw_value == 'vacant'" class="booking-card d-flex flex-column gap-2 justify-content-center">

                                    <div class="booking-card-header d-flex justify-content-between align-items-center border-0">


                                        <div class="d-flex justify-content-between align-items-center mb-2">


                                            <p class="label-subtext mb-0">

                                                <field name="name"/>

                                                /

                                                <field name="categ_id"/>

                                            </p>

                                        </div>
                                        <div>

                                            <p class="mb-0 vacant-label" t-if="record.room_state.raw_value == 'vacant'">

                                                vacant

                                            </p>

                                            <p t-elif="record.room_state.value"

                                               t-attf-class="mb-0 badge bg-info vacant-label">

                                                <t t-esc="record.room_state.value"/>

                                            </p>

                                        </div>

                                    </div>

                                    <div class="booking-card-footer justify-content-center align-items-center">

                                        <a class="confirm-btn o_project_kanban_box text-white"

                                           name="action_create_future_reservation" type="object">

                                            New Reservation

                                        </a>

                                    </div>

                                </div>
                                <div t-else="" class="booking-card d-flex flex-column gap-2 justify-content-center">

                                    <div class="booking-card-header d-flex justify-content-between align-items-center">

                                        <div class="header-bar">

                                            <strong t-if="record.room_partner_id.raw_value">

                                                <field name="room_partner_id"/>

                                            </strong>

                                            <br/>

                                            <span t-if="record.room_ref.raw_value" class="booking-info">

                                                <field name="room_ref"/>

                                            </span>

                                        </div>

                                        <div>

                                            <p class="mb-0 vacant-label" t-if="record.room_state.raw_value == 'vacant'">

                                                vacant

                                            </p>

                                            <!-- Booking -->
                                            <p t-elif="record.room_state.value == 'Booking'"
                                            class="mb-0 badge vacant-label"
                                            style="background-color:#67b7e6;">
                                            <t t-esc="record.room_state.value"/>
                                            </p>

                                            <!-- Checked In -->
                                            <p t-elif="record.room_state.value == 'Checked In'"
                                            class="mb-0 badge vacant-label"
                                            style="background-color:#6fbca7;">
                                            <t t-esc="record.room_state.value"/>
                                            </p>

                                            <!-- Checked Out -->
                                            <p t-elif="record.room_state.value == 'Checked Out'"
                                            class="mb-0 badge vacant-label"
                                            style="background-color:#f99d72;">
                                            <t t-esc="record.room_state.value"/>
                                            </p>

                                            <!-- Confirmed -->
                                            <p t-elif="record.room_state.value == 'Confirmed'"
                                            class="mb-0 badge vacant-label"
                                            style="background-color:#d1a983;">
                                            <t t-esc="record.room_state.value"/>
                                            </p>


                                        </div>

                                    </div>

                                    <div class="booking-card-body">

                                        <div class="date-row date-row-1">

                                            <!-- Check-in -->

                                            <div class="checkin-date text-center w-100">

                                                <p class="mb-0" style="font-size:13px;font-weight: 600;"

                                                   t-if="record.room_check_in.raw_value">

                                                    <field name="room_check_in"/>

                                                </p>

                                                <p class="label-subtext mb-0"

                                                   t-if="record.room_check_in_time.raw_value">

                                                    <field name="room_check_in_time"/>

                                                </p>

                                            </div>

                                            <div class="days-number days-number-1 text-center w-100"

                                                 style="border-radius: 4px;">

                                                <p t-if="record.room_total_nights.raw_value" style="font-weight: 600;">

                                                    <field name="room_total_nights"/>

                                                </p>

                                                <p style="font-size:13px; font-weight:600; line-height:0rem;">

                                                    Nights

                                                </p>

                                            </div>

                                            <div class="checkout-date text-center w-100">

                                                <p class="mb-0" style="font-size:13px;font-weight: 600;"

                                                   t-if="record.room_check_out.raw_value">

                                                    <field name="room_check_out"/>

                                                </p>

                                                <p class="label-subtext mb-0"

                                                   t-if="record.room_check_out_time.raw_value">

                                                    <field name="room_check_out_time"/>

                                                </p>

                                            </div>

                                        </div>

                                        <div class="d-flex justify-content-between align-items-center mb-2">

                                            <div t-if="record.room_booking_date.raw_value">

                                                <p class="label-title mb-0">

                                                    Booking Date

                                                </p>

                                                <p class="label-subtexte mb-0">

                                                    <field name="room_booking_date"/>

                                                </p>

                                            </div>

                                            <div t-if="record.room_adults.raw_value or record.room_children.raw_value">

                                                <strong>

                                                    <i class="fa fa-male" style="font-size:20px;"/>

                                                    <field name="room_adults"/>

                                                    <i class="fa fa-child mx-1" style="font-size: 16px;"/>

                                                    <field name="room_children"/>

                                                </strong>

                                            </div>

                                        </div>

                                        <div class="d-flex justify-content-between align-items-center mb-2">

                                            <p class="label-title mb-0">

                                                Room / Room Type

                                            </p>

                                            <p class="label-subtext mb-0">

                                                <field name="name"/>

                                                /

                                                <field name="categ_id"/>

                                            </p>

                                        </div>

                                        <div class="d-flex justify-content-between align-items-center mb-2"

                                             t-if="record.room_total_price.raw_value">

                                            <p class="label-title mb-0 text-primary">

                                                Total

                                            </p>

                                            <p class="label-subtext mb-0 text-primary" style="font-weight:600;">

                                                <field name="room_total_price"/>

                                            </p>

                                        </div>

                                    </div>

                                    <div class="booking-card-footer">

                                        <a class="confirm-btn o_project_kanban_box text-white"

                                           name="action_create_future_reservation" type="object">

                                            New Reservation

                                        </a>

                                    </div>

                                </div>

                            </t>

                        </templates>

                    </kanban>

                </xpath>

            </field>

        </record>

        <record id="hotel_room_filter" model="ir.ui.view">

            <field name="name">hotel_room_filter</field>

            <field name="model">hotel.room</field>

            <field name="arch" type="xml">

                <search string="Search Rooms">

                    <field name="name" string="Name"/>

                    <searchpanel>

                        <field name="room_state" string="Status" icon="fa-clipboard" enable_counters="1"/>

                        <field name="shop_id" icon="fa-building" enable_counters="1"/>

                        <field name="categ_id" string="Room Type" icon="fa-hotel" enable_counters="1"/>

                        <field name="floor_id" string="Floor" icon="fa-list" enable_counters="1"/>

                    </searchpanel>

                    <separator/>

                    <group expand="0" string="Group By">

                        <filter string="Room Type" name="room_type" context="{'group_by':'categ_id'}"/>

                        <filter string="Floor" name="floor" context="{'group_by':'floor_id'}"/>

                        <filter string="Status" name="room_state" context="{'group_by':'room_state'}"/>

                        <filter string="Hotel" name="hotel" context="{'group_by': 'shop_id'}"/>

                        <filter string="Max Adults" name="max_adult" context="{'group_by':'max_adult'}"/>

                    </group>

                </search>

            </field>

        </record>

        <record model="ir.actions.act_window" id="action_hotel_room_dashboard">

            <field name="name">Hotel Room</field>

            <field name="res_model">hotel.room</field>

            <field name="view_mode">kanban,tree,form</field>

            <field name="search_view_id" ref="hotel_room_filter"/>

            <field name="domain">[('company_id', 'in', context.get('allowed_company_ids'))]</field>

        </record>



        <record id="hotel.action_hotel_room_form" model="ir.actions.act_window">

            <field name="search_view_id" ref="hotel_room_filter"/>

            <field name="view_mode">tree,form</field>

        </record>

        <menuitem id="custom_room_menu" name="Rooms" parent="hotel_dashboard.menu_root"

                  action="action_hotel_room_dashboard" sequence="20"/>

    </data>

</odoo>
